# Обзор нововведений Telegram Bot API 9.3

## 1. Стриминг сообщений (`sendMessageDraft`)

Это, пожалуй, самое важное обновление для AI-ботов. Ранее для эффекта "печатания" приходилось отправлять сообщение, а затем многократно редактировать его (`editMessageText`), что часто приводило к ошибке `429 Too Many Requests`.

Теперь Telegram внедрил нативный метод для потоковой передачи текста.

### Как это работает:
1.  **Начало генерации**: Бот вызывает метод `sendMessageDraft`. В этот момент у пользователя появляется "пузырь" сообщения с индикатором печатания или курсором.
2.  **Поток данных**: Бот продолжает отправлять чанки (кусочки текста) в этот же метод. Telegram сам обновляет сообщение на клиенте в реальном времени.
3.  **Завершение**: Когда генерация окончена, бот отправляет финальный текст через обычный `sendMessage` (или метод завершения драфта), превращая его в обычное сообщение.

**Преимущества:**
*   **Скорость**: Пользователь видит текст сразу, как он генерируется.
*   **Экономия лимитов**: Нет риска получить бан за частое редактирование.
*   **UX**: Выглядит как нативная работа, аналогично ChatGPT или Gemini.

---

## 2. Темы (Форумы) в личных чатах

Telegram разрешил пользователям включать режим "Темы" в личных переписках с ботами. Это позволяет структурировать общение.

### Технические детали:
*   **Поле `has_topics_enabled`**: В объекте `User` (информация о пользователе) появился флаг, показывающий, включены ли у пользователя темы в ЛС с ботом.
*   **Адресация (`message_thread_id`)**: Теперь при отправке сообщений в ЛС (`sendMessage`, `sendPhoto` и др.) можно указывать `message_thread_id`. Если он указан, сообщение уйдет в конкретную тему.
*   **Управление темами**:
    *   `editForumTopic`: Бот может менять название и иконку темы.
    *   `deleteForumTopic`: Бот может удалить тему.
    *   `unpinAllForumTopicMessages`: Бот может открепить сообщения в теме.
    *   **Важно**: Метода `createForumTopic` для ЛС нет. Инициатива создания темы всегда исходит от пользователя.

### Сценарии использования:
1.  **Сортировка контента**: Пользователь может создать тему "Картинки" и "Текст". Если он пишет в "Картинки", бот может отвечать туда же.
2.  **Контексты**: Можно договориться, что в теме "Код" бот ведет себя как программист, а в теме "Болталка" — как друг.

> [!NOTE]
> Бот не может принудительно создать тему, но если пользователь написал из темы, бот получает `message_thread_id` и может запомнить, что этот ID соответствует определенному контексту.
